package leetcode.editor.cn;

//ч╗Щф╜аф╕Аф╕кцХ┤цХ░ n я╝МхЕ▒цЬЙч╝ЦхП╖ф╗О 0 хИ░ n - 1 чЪД n ф╕кф╝ЪшооходуАВ 
//
// ч╗Щф╜аф╕Аф╕кф║Мч╗┤цХ┤цХ░цХ░ч╗Д meetings я╝МхЕ╢ф╕н meetings[i] = [starti, endi] шбичд║ф╕АхЬ║ф╝Ъшоох░Жф╝ЪхЬи хНКщЧн цЧ╢щЧ┤хМ║щЧ┤ [
//starti, endi) ф╕╛хКЮуАВцЙАцЬЙ starti чЪДхА╝ ф║Тф╕НчЫ╕хРМ уАВ 
//
// ф╝Ъшоох░Жф╝ЪцМЙф╗еф╕ЛцЦ╣х╝ПхИЖщЕНч╗Щф╝Ъшооходя╝Ъ 
//
// 
// цпПхЬ║ф╝ЪшоощГ╜ф╝ЪхЬицЬкхНачФиф╕Фч╝ЦхП╖ цЬАх░П чЪДф╝Ъшооходф╕╛хКЮуАВ 
// хжВцЮЬц▓бцЬЙхПпчФичЪДф╝Ъшооходя╝Мф╝Ъшоох░Жф╝Ъх╗╢цЬЯя╝МчЫ┤хИ░хнШхЬичй║щЧ▓чЪДф╝ЪшооходуАВх╗╢цЬЯф╝ЪшоочЪДцМБч╗нцЧ╢щЧ┤хТМхОЯф╝ЪшооцМБч╗нцЧ╢щЧ┤ чЫ╕хРМ уАВ 
// х╜Уф╝ЪшооходхдДф║ОцЬкхНачФичК╢цАБцЧ╢я╝Мх░Жф╝Ъф╝ШхЕИцПРф╛Ыч╗ЩхОЯ х╝АхзЛ цЧ╢щЧ┤цЫ┤цЧйчЪДф╝ЪшооуАВ 
// 
//
// ш┐ФхЫЮф╕╛хКЮцЬАхдЪцмбф╝ЪшоочЪДцИ┐щЧ┤ ч╝ЦхП╖ уАВхжВцЮЬхнШхЬихдЪф╕кцИ┐щЧ┤ц╗бш╢│цндцЭбф╗╢я╝МхИЩш┐ФхЫЮч╝ЦхП╖ цЬАх░П чЪДцИ┐щЧ┤уАВ 
//
// хНКщЧнхМ║щЧ┤ [a, b) цШп a хТМ b ф╣ЛщЧ┤чЪДхМ║щЧ┤я╝МхМЕцЛм a ф╜Ж ф╕НхМЕцЛм b уАВ 
//
// 
//
// чд║ф╛Л 1я╝Ъ 
//
// ш╛УхЕея╝Ъn = 2, meetings = [[0,10],[1,5],[2,7],[3,4]]
//ш╛УхЗ║я╝Ъ0
//шзгщЗКя╝Ъ
//- хЬицЧ╢щЧ┤ 0 я╝Мф╕дф╕кф╝ЪшооходщГ╜цЬкхНачФия╝Мчммф╕АхЬ║ф╝ЪшоохЬиф╝Ъшооход 0 ф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 1 я╝МхПкцЬЙф╝Ъшооход 1 цЬкхНачФия╝Мчммф║МхЬ║ф╝ЪшоохЬиф╝Ъшооход 1 ф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 2 я╝Мф╕дф╕кф╝ЪшооходщГ╜швлхНачФия╝Мчммф╕ЙхЬ║ф╝Ъшоох╗╢цЬЯф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 3 я╝Мф╕дф╕кф╝ЪшооходщГ╜швлхНачФия╝МчммхЫЫхЬ║ф╝Ъшоох╗╢цЬЯф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 5 я╝Мф╝Ъшооход 1 чЪДф╝Ъшооч╗УцЭЯуАВчммф╕ЙхЬ║ф╝ЪшоохЬиф╝Ъшооход 1 ф╕╛хКЮя╝МцЧ╢щЧ┤хСицЬЯф╕║ [5,10) уАВ
//- хЬицЧ╢щЧ┤ 10 я╝Мф╕дф╕кф╝ЪшооходчЪДф╝ЪшоощГ╜ч╗УцЭЯуАВчммхЫЫхЬ║ф╝ЪшоохЬиф╝Ъшооход 0 ф╕╛хКЮя╝МцЧ╢щЧ┤хСицЬЯф╕║ [10,11) уАВ
//ф╝Ъшооход 0 хТМф╝Ъшооход 1 щГ╜ф╕╛хКЮф║Ж 2 хЬ║ф╝Ъшооя╝МцЙАф╗еш┐ФхЫЮ 0 уАВ 
// 
//
// чд║ф╛Л 2я╝Ъ 
//
// ш╛УхЕея╝Ъn = 3, meetings = [[1,20],[2,10],[3,5],[4,9],[6,8]]
//ш╛УхЗ║я╝Ъ1
//шзгщЗКя╝Ъ
//- хЬицЧ╢щЧ┤ 1 я╝МцЙАцЬЙф╕Йф╕кф╝ЪшооходщГ╜цЬкхНачФия╝Мчммф╕АхЬ║ф╝ЪшоохЬиф╝Ъшооход 0 ф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 2 я╝Мф╝Ъшооход 1 хТМ 2 цЬкхНачФия╝Мчммф║МхЬ║ф╝ЪшоохЬиф╝Ъшооход 1 ф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 3 я╝МхПкцЬЙф╝Ъшооход 2 цЬкхНачФия╝Мчммф╕ЙхЬ║ф╝ЪшоохЬиф╝Ъшооход 2 ф╕╛хКЮуАВ
//- хЬицЧ╢щЧ┤ 4 я╝МцЙАцЬЙф╕Йф╕кф╝ЪшооходщГ╜швлхНачФия╝МчммхЫЫхЬ║ф╝Ъшоох╗╢цЬЯф╕╛хКЮуАВ 
//- хЬицЧ╢щЧ┤ 5 я╝Мф╝Ъшооход 2 чЪДф╝Ъшооч╗УцЭЯуАВчммхЫЫхЬ║ф╝ЪшоохЬиф╝Ъшооход 2 ф╕╛хКЮя╝МцЧ╢щЧ┤хСицЬЯф╕║ [5,10) уАВ
//- хЬицЧ╢щЧ┤ 6 я╝МцЙАцЬЙф╕Йф╕кф╝ЪшооходщГ╜швлхНачФия╝Мчммф║ФхЬ║ф╝Ъшоох╗╢цЬЯф╕╛хКЮуАВ 
//- хЬицЧ╢щЧ┤ 10 я╝Мф╝Ъшооход 1 хТМ 2 чЪДф╝Ъшооч╗УцЭЯуАВчммф║ФхЬ║ф╝ЪшоохЬиф╝Ъшооход 1 ф╕╛хКЮя╝МцЧ╢щЧ┤хСицЬЯф╕║ [10,12) уАВ 
//ф╝Ъшооход 1 хТМф╝Ъшооход 2 щГ╜ф╕╛хКЮф║Ж 2 хЬ║ф╝Ъшооя╝МцЙАф╗еш┐ФхЫЮ 1 уАВ 
// 
//
// 
//
// цПРчд║я╝Ъ 
//
// 
// 1 <= n <= 100 
// 1 <= meetings.length <= 10тБ╡ 
// meetings[i].length == 2 
// 0 <= starti < endi <= 5 * 10тБ╡ 
// starti чЪДцЙАцЬЙхА╝ ф║Тф╕НчЫ╕хРМ 
// 
//
// ЁЯСН 10 ЁЯСО 0

import java.util.Arrays;
import java.util.PriorityQueue;
import java.util.TreeSet;

public class MeetingRoomsIii{
         public static void main(String[] args) {
            Solution solution = new MeetingRoomsIii().new Solution();
            //[[0,10],[1,5],[2,7],[3,4]]
             System.out.println(solution.mostBooked(3,new int[][]{{0,10},{1,5},{2,7},{3,4}}));
 }

//leetcode submit region begin(Prohibit modification and deletion)
class Solution {
    private class Pair<K, V> {
        public K first;
        public V second;
        public Pair(K first, V second) {
            this.first = first;
            this.second = second;
        }
    }

    public int mostBooked(int n, int[][] meetings) {
        // цМЙх╝АхзЛцЧ╢щЧ┤цОТх║П
        Arrays.sort(meetings, (x, y) -> x[0] - y[0]);
        int[] count = new int[n];
        // TreeSet шо░х╜ХцндцЧ╢цЙАцЬЙхПпчФичЪДф╝Ъшооходя╝Иф╣ЯхПпф╗ечФи PriorityQueueя╝Й
        TreeSet<Integer> meetingRoom = new TreeSet<>();
        for (int i = 0; i < n; i++)
            meetingRoom.add(i);
        // ф╝ШхЕИщШЯхИЧшо░х╜Х {ч╗УцЭЯцЧ╢щЧ┤я╝МхНачФичЪДф╝Ъшооход}я╝Мф╝ШхЕИцМЙчЕзч╗УцЭЯцЧ╢щЧ┤цОТх║П
        PriorityQueue<Pair<Long, Integer>> heap = new PriorityQueue<>((x, y) -> Long.compare(x.first, y.first) == 0 ? x.second - y.second : Long.compare(x.first, y.first));
        // щб║х║ПщБНхОЖф╝Ъшооходя╝МхЕИщБНхОЖхИ░чЪДшВпхоЪцШпх╝АхзЛцЧ╢щЧ┤цЧйчЪД
        for (int[] meeting : meetings) {
            // хжВцЮЬцЬЙч╗УцЭЯцЧ╢щЧ┤цЧйф║Ох╜УхЙНф╝Ъшоох╝АхзЛцЧ╢щЧ┤чЪДф╝Ъшооя╝МщГ╜хЕИх╝╣хЗ║ф╝ШхЕИщШЯхИЧя╝Иф╕Нф╝Ъхп╣хРОщЭвчЪДф╝ЪшоощАацИРх╜▒хУНя╝Й
            while (!heap.isEmpty() && meeting[0] >= heap.peek().first)
                meetingRoom.add(heap.poll().second);
            // хжВцЮЬ TreeSet ф╕ншО╖хПЦф╕НхИ░чй║чЪДф╝Ъшооходя╝Мх░▒х╝╣хЗ║цЬАцЧйч╗УцЭЯчЪДф╝ЪшооцККф╝ЪшооходшЕ╛хЗ║цЭея╝Мф╜ЖцШпч╗УцЭЯцЧ╢щЧ┤шжБшо╛ч╜оф╕║"х╝╣хЗ║ф╝ЪшоочЪДч╗УцЭЯцЧ╢щЧ┤ + х╜УхЙНф╝ЪшоочЪДцМБч╗нцЧ╢щЧ┤"я╝МхЫаф╕║шжБчнЙх╛Еф╝Ъшооч╗УцЭЯ
            if (meetingRoom.isEmpty()) {
                Pair<Long, Integer> cur = heap.poll();
                count[cur.second]++;
                heap.offer(new Pair<>(cur.first + (long) meeting[1] - meeting[0], cur.second));
            }
            // цЬЙчй║ф╝ЪшооходчЫ┤цОехИЖщЕНхН│хПп
            else {
                int get = meetingRoom.first();
                heap.offer(new Pair<>((long) meeting[1], get));
                count[get]++;
                meetingRoom.remove(get);
            }
        }
        // цЬАхРОшобчоЧцЬАхдзчЪДф╝Ъшооходф╕ЛцаЗ
        int max = 0;
        for (int i = 1; i < n; i++)
            if (count[max] < count[i])
                max = i;
        return max;
    }
}


//leetcode submit region end(Prohibit modification and deletion)

}
